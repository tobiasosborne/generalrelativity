% fig_lec03_ellipsoid.tex â€” Geodesics + tangent/parallel transport on ellipsoid
% Data: generated by scripts/sim_lec03.jl

% Panel (a): Ellipsoid with geodesics
\begin{center}
\begin{tikzpicture}
\begin{axis}[
    gr3d,
    xlabel={$x$}, ylabel={$y$}, zlabel={$z$},
    title={Geodesics on a triaxial ellipsoid},
    view={-25}{30},
    xmin=-1.7, xmax=1.7,
    ymin=-1.2, ymax=1.2,
    zmin=-0.85, zmax=0.85,
]
    % Ellipsoid surface (faint)
    \addplot3[
        surf,
        opacity=0.25,
        shader=interp,
        colormap name=grsurface,
        forget plot,
        mesh/rows=60,
    ] table {data/lec03_ellipsoid.dat};

    % Geodesics
    \addplot3[cgblue, line width=1.2pt, no markers]
        table {data/lec03_geodesic_1.dat};
    \addplot3[munsell, line width=1.2pt, no markers]
        table {data/lec03_geodesic_2.dat};
    \addplot3[banana!80!black, line width=1.2pt, no markers]
        table {data/lec03_geodesic_3.dat};
    \addplot3[spacecadet, line width=1.2pt, no markers]
        table {data/lec03_geodesic_4.dat};
\end{axis}
\end{tikzpicture}

\bigskip

% Panel (b): Tangent vectors + parallel transport along geodesic 1
\begin{tikzpicture}
\begin{axis}[
    gr3d,
    xlabel={$x$}, ylabel={$y$}, zlabel={$z$},
    title={Tangent vectors and parallel transport},
    view={-25}{30},
    xmin=-1.7, xmax=1.7,
    ymin=-1.2, ymax=1.2,
    zmin=-0.85, zmax=0.85,
]
    % Ellipsoid surface (very faint)
    \addplot3[
        surf,
        opacity=0.15,
        shader=interp,
        colormap name=grsurface,
        forget plot,
        mesh/rows=60,
    ] table {data/lec03_ellipsoid.dat};

    % Geodesic curve
    \addplot3[cgblue, line width=1.0pt, no markers]
        table {data/lec03_geodesic_1.dat};

    % Tangent vectors (banana arrows)
    \addplot3[
        quiver={u=\thisrowno{3}, v=\thisrowno{4}, w=\thisrowno{5}},
        -{Stealth[length=4pt, width=3pt]},
        banana!80!black, line width=0.8pt,
        no markers,
    ] table[x index=0, y index=1, z index=2] {data/lec03_tangent_1.dat};

    % Parallel-transported vectors (munsell arrows)
    \addplot3[
        quiver={u=\thisrowno{3}, v=\thisrowno{4}, w=\thisrowno{5}},
        -{Stealth[length=4pt, width=3pt]},
        munsell, line width=0.8pt,
        no markers,
    ] table[x index=0, y index=1, z index=2] {data/lec03_parallel_1.dat};

    % Legend
    \addlegendimage{banana!80!black, line width=0.8pt, -{Stealth[length=4pt]}}
    \addlegendentry{tangent $\dot\gamma$}
    \addlegendimage{munsell, line width=0.8pt, -{Stealth[length=4pt]}}
    \addlegendentry{parallel transport}
\end{axis}
\end{tikzpicture}
\end{center}
