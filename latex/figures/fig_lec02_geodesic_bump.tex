% fig_lec02_geodesic_bump.tex — Parallel geodesics on a Gaussian-bump surface
% Data: generated by scripts/sim_lec02.jl
% 9 initially parallel geodesics (all moving in +x) deflected by the bump

% Panel (a): 3D surface with geodesics
\begin{center}
\begin{tikzpicture}
\begin{axis}[
    gr3d,
    xlabel={$x$}, ylabel={$y$}, zlabel={$z$},
    title={Initially parallel geodesics on a Gaussian bump},
    view={-35}{32},
    zmin=-0.05, zmax=1.15,
    xmin=-3, xmax=3,
    ymin=-3, ymax=3,
]
    % Surface mesh (faint)
    \addplot3[
        surf,
        opacity=0.35,
        shader=interp,
        colormap name=grsurface,
        forget plot,
        mesh/rows=50,
    ] table {data/lec02_surface.dat};

    % 9 geodesics: colour gradient from cgblue (bottom) through munsell to spacecadet (top)
    \addplot3[spacecadet!70!cgblue, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_1.dat};
    \addplot3[spacecadet!50!cgblue, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_2.dat};
    \addplot3[cgblue!80!munsell, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_3.dat};
    \addplot3[cgblue, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_4.dat};
    \addplot3[munsell, line width=1.3pt, no markers, forget plot]
        table {data/lec02_geodesic_5.dat};
    \addplot3[cgblue, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_6.dat};
    \addplot3[cgblue!80!munsell, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_7.dat};
    \addplot3[spacecadet!50!cgblue, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_8.dat};
    \addplot3[spacecadet!70!cgblue, line width=1.0pt, no markers, forget plot]
        table {data/lec02_geodesic_9.dat};
\end{axis}
\end{tikzpicture}

\bigskip

% Panel (b): Top-down comparison — geodesics vs undeflected straight lines
\begin{tikzpicture}
\begin{axis}[
    grplot,
    width=8cm, height=8cm,
    xlabel={$x$}, ylabel={$y$},
    title={Geodesic (solid) vs.\ undeflected (dashed)},
    xmin=-3, xmax=3,
    ymin=-2.5, ymax=2.5,
    axis equal,
]
    % Bump contour (faint circle at 1σ)
    \draw[spacecadet!15, thick] (axis cs:0,0) circle[radius=100];
    \addplot[spacecadet!20, domain=0:360, samples=72, no markers, thick, forget plot]
        ({cos(x)}, {sin(x)});
    \addplot[spacecadet!10, domain=0:360, samples=72, no markers, forget plot]
        ({2*cos(x)}, {2*sin(x)});

    % Straight lines (dashed, faint) — undeflected parallel paths
    \foreach \i in {1,...,9} {
        \addplot[spacecadet!25, line width=0.5pt, dashed, no markers, forget plot]
            table[x index=0, y index=1] {data/lec02_straight_\i.dat};
    }

    % Geodesics (solid) — colour gradient matching 3D panel
    \addplot[spacecadet!70!cgblue, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_1.dat};
    \addplot[spacecadet!50!cgblue, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_2.dat};
    \addplot[cgblue!80!munsell, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_3.dat};
    \addplot[cgblue, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_4.dat};
    \addplot[munsell, line width=1.1pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_5.dat};
    \addplot[cgblue, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_6.dat};
    \addplot[cgblue!80!munsell, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_7.dat};
    \addplot[spacecadet!50!cgblue, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_8.dat};
    \addplot[spacecadet!70!cgblue, line width=0.9pt, no markers, forget plot]
        table[x index=0, y index=1] {data/lec02_geodesic_9.dat};

    % Bump center marker
    \addplot[only marks, mark=+, mark size=4pt, spacecadet!40, thick]
        coordinates {(0,0)};
\end{axis}
\end{tikzpicture}
\end{center}
